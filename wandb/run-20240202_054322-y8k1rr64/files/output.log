392
278
Training...
Batch loss: 0.011989104561507702
Batch loss: 0.005763158202171326
Batch loss: 0.032151639461517334
Batch loss: 0.001350490259937942
Batch loss: 0.003386028576642275
Batch loss: 0.008833295665681362
Batch loss: 0.00294899451546371
Batch loss: 0.002137858187779784
Batch loss: 0.02428079955279827
Batch loss: 0.37948158383369446
Batch loss: 0.028707999736070633
Batch loss: 0.0008091828785836697
Batch loss: 0.032400213181972504
Batch loss: 0.021435866132378578
Batch loss: 0.007109429687261581
Batch loss: 0.011038810014724731
Batch loss: 0.0005364550743252039
Batch loss: 0.0003693814214784652
Traceback (most recent call last):
  File "/home/franlucc/projects/codetrace/train.py", line 283, in <module>
    train_loop(llm)
  File "/home/franlucc/projects/codetrace/train.py", line 204, in train_loop
    causal_loss, _ = apply_mask(llm, output, prompts, correct_idxs, incorrect_idxs)
  File "/home/franlucc/projects/codetrace/train.py", line 80, in apply_mask
    with llm.generate(max_new_tokens=1,
  File "/home/franlucc/venvs/gpu/lib/python3.10/site-packages/nnsight/contexts/Runner.py", line 73, in __exit__
    self.run_local()
  File "/home/franlucc/venvs/gpu/lib/python3.10/site-packages/nnsight/contexts/Runner.py", line 78, in run_local
    self.output = self.model(
  File "/home/franlucc/venvs/gpu/lib/python3.10/site-packages/nnsight/models/NNsightModel.py", line 200, in __call__
    gc.collect()
KeyboardInterrupt