264
216
Training...
Batch loss: 0.48216772079467773
Batch loss: 0.27547571063041687
Batch loss: 0.448486328125
Batch loss: 0.3929232358932495
Batch loss: 0.5005900263786316
Batch loss: 0.1812754124403
Batch loss: 0.37179699540138245
Batch loss: 0.41786739230155945
Batch loss: 0.58449786901474
Batch loss: 0.4639786183834076
Batch loss: 0.4415767192840576
Batch loss: 0.46196243166923523
Batch loss: 0.48628076910972595
Batch loss: 0.4932268261909485
Batch loss: 0.6351481676101685
Batch loss: 0.31889888644218445
Batch loss: 0.4769659638404846
Batch loss: 0.5123838782310486
Batch loss: 0.3023143708705902
Batch loss: 0.4496597349643707
Batch loss: 0.3473646342754364
Batch loss: 0.4317943751811981
Batch loss: 0.39561447501182556
Batch loss: 0.4167289435863495
Batch loss: 0.42568713426589966
Batch loss: 0.4789981544017792
Batch loss: 0.5624802708625793
Batch loss: 0.44594699144363403
Batch loss: 0.3003133237361908
Batch loss: 0.6671770811080933
Batch loss: 0.43710294365882874
Batch loss: 0.2285967618227005
Batch loss: 0.48334017395973206
Traceback (most recent call last):
  File "/home/franlucc/projects/codetrace/train.py", line 272, in <module>
    train_loop(llm)
  File "/home/franlucc/projects/codetrace/train.py", line 196, in train_loop
    causal_loss, _ = apply_mask(llm, output, prompts, correct_idxs, incorrect_idxs)
  File "/home/franlucc/projects/codetrace/train.py", line 79, in apply_mask
    with llm.generate(max_new_tokens=1,
  File "/home/franlucc/venvs/gpu/lib/python3.10/site-packages/nnsight/contexts/Runner.py", line 73, in __exit__
    self.run_local()
  File "/home/franlucc/venvs/gpu/lib/python3.10/site-packages/nnsight/contexts/Runner.py", line 78, in run_local
    self.output = self.model(
  File "/home/franlucc/venvs/gpu/lib/python3.10/site-packages/nnsight/models/NNsightModel.py", line 194, in __call__
    output = fn(inputs, *args, **kwargs)
  File "/home/franlucc/venvs/gpu/lib/python3.10/site-packages/nnsight/models/LanguageModel.py", line 166, in _generation
    return super()._generation(
  File "/home/franlucc/venvs/gpu/lib/python3.10/site-packages/nnsight/models/NNsightModel.py", line 412, in _generation
    return self.local_model.generate(
  File "/home/franlucc/venvs/gpu/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
  File "/home/franlucc/venvs/gpu/lib/python3.10/site-packages/transformers/generation/utils.py", line 1474, in generate
    return self.greedy_search(
  File "/home/franlucc/venvs/gpu/lib/python3.10/site-packages/transformers/generation/utils.py", line 2392, in greedy_search
    if unfinished_sequences.max() == 0:
KeyboardInterrupt