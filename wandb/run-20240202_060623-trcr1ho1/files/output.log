392
278
Training...
Batch loss: 18.598392486572266
Batch loss: 92.4719009399414
Batch loss: 45.83929443359375
Batch loss: 8.35734748840332
Batch loss: 28.9898681640625
Batch loss: 69.03081512451172
Batch loss: 38.06654739379883
Batch loss: 50.08757400512695
Batch loss: 43.47843551635742
Batch loss: 85.05355072021484
Batch loss: 5.273381233215332
Batch loss: 288.6908874511719
Batch loss: 235.95388793945312
Batch loss: 6.923253059387207
Batch loss: 25.84912109375
Batch loss: 7.9714508056640625
Batch loss: 38.048309326171875
Batch loss: 37.22924041748047
Batch loss: -0.7339782118797302
Batch loss: 92.87399291992188
Batch loss: 29.24299430847168
Batch loss: 125.10060119628906
Batch loss: 31.27412223815918
Batch loss: 135.23272705078125
Batch loss: 8.076251029968262
Batch loss: 14.480745315551758
Batch loss: 19.363624572753906
Batch loss: 1.3962215185165405
Batch loss: 166.2350311279297
Batch loss: 21.261661529541016
Batch loss: 33.40279769897461
Batch loss: 19.750524520874023
Batch loss: 0.07077083736658096
Batch loss: 32.14066696166992
Batch loss: 10.124069213867188
Batch loss: 4.927530765533447
Batch loss: 45.34598922729492
Batch loss: 37.283233642578125
Batch loss: 14.710197448730469
Batch loss: 22.335174560546875
Batch loss: 51.81337356567383
Batch loss: 7.295861721038818
Batch loss: 98.88672637939453
Batch loss: -1.3056429624557495
Batch loss: 1.3444393873214722
Batch loss: 131.96958923339844
Batch loss: 11.969878196716309
Batch loss: 94.64581298828125
Batch loss: 20.30409049987793
Batch loss: 15.7558012008667
Batch loss: 0.6512452363967896
Batch loss: 41.01130294799805
Batch loss: 19.161739349365234
Batch loss: 6.513287544250488
Batch loss: 462.141357421875
Batch loss: -2.803375244140625
Epoch: 1 	Training Loss: 52.663637
Batch loss: 18.598392486572266
Batch loss: 92.4719009399414
Traceback (most recent call last):
  File "/home/franlucc/projects/codetrace/train.py", line 283, in <module>
    train_loop(llm)
  File "/home/franlucc/projects/codetrace/train.py", line 204, in train_loop
    causal_loss, _ = apply_mask(llm, output, prompts, correct_idxs, incorrect_idxs)
  File "/home/franlucc/projects/codetrace/train.py", line 80, in apply_mask
    with llm.generate(max_new_tokens=1,
  File "/home/franlucc/venvs/gpu/lib/python3.10/site-packages/nnsight/contexts/Runner.py", line 73, in __exit__
    self.run_local()
  File "/home/franlucc/venvs/gpu/lib/python3.10/site-packages/nnsight/contexts/Runner.py", line 78, in run_local
    self.output = self.model(
  File "/home/franlucc/venvs/gpu/lib/python3.10/site-packages/nnsight/models/NNsightModel.py", line 194, in __call__
    output = fn(inputs, *args, **kwargs)
  File "/home/franlucc/venvs/gpu/lib/python3.10/site-packages/nnsight/models/LanguageModel.py", line 166, in _generation
    return super()._generation(
  File "/home/franlucc/venvs/gpu/lib/python3.10/site-packages/nnsight/models/NNsightModel.py", line 412, in _generation
    return self.local_model.generate(
  File "/home/franlucc/venvs/gpu/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
  File "/home/franlucc/venvs/gpu/lib/python3.10/site-packages/transformers/generation/utils.py", line 1474, in generate
    return self.greedy_search(
  File "/home/franlucc/venvs/gpu/lib/python3.10/site-packages/transformers/generation/utils.py", line 2335, in greedy_search
    outputs = self(
  File "/home/franlucc/venvs/gpu/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/franlucc/venvs/gpu/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1568, in _call_impl
    result = forward_call(*args, **kwargs)
  File "/home/franlucc/venvs/gpu/lib/python3.10/site-packages/accelerate/hooks.py", line 165, in new_forward
    output = module._old_forward(*args, **kwargs)
  File "/home/franlucc/venvs/gpu/lib/python3.10/site-packages/transformers/models/gpt_bigcode/modeling_gpt_bigcode.py", line 1265, in forward
    transformer_outputs = self.transformer(
  File "/home/franlucc/venvs/gpu/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/franlucc/venvs/gpu/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/franlucc/venvs/gpu/lib/python3.10/site-packages/transformers/models/gpt_bigcode/modeling_gpt_bigcode.py", line 1118, in forward
    outputs = block(
  File "/home/franlucc/venvs/gpu/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/franlucc/venvs/gpu/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/franlucc/venvs/gpu/lib/python3.10/site-packages/accelerate/hooks.py", line 160, in new_forward
    args, kwargs = module._hf_hook.pre_forward(module, *args, **kwargs)
  File "/home/franlucc/venvs/gpu/lib/python3.10/site-packages/accelerate/hooks.py", line 297, in pre_forward
    return send_to_device(args, self.execution_device), send_to_device(
  File "/home/franlucc/venvs/gpu/lib/python3.10/site-packages/accelerate/utils/operations.py", line 161, in send_to_device
    {
  File "/home/franlucc/venvs/gpu/lib/python3.10/site-packages/accelerate/utils/operations.py", line 162, in <dictcomp>
    k: t if k in skip_keys else send_to_device(t, device, non_blocking=non_blocking, skip_keys=skip_keys)
  File "/home/franlucc/venvs/gpu/lib/python3.10/site-packages/accelerate/utils/operations.py", line 171, in send_to_device
    return tensor.to(device, non_blocking=non_blocking)
KeyboardInterrupt