392
278
Training...
Batch loss: -0.3405139446258545
Batch loss: 0.2577377259731293
Batch loss: 0.21463148295879364
Batch loss: -0.08764176815748215
Batch loss: 3.837609052658081
Batch loss: -0.004569840617477894
Batch loss: 0.8103189468383789
Batch loss: 1.7012958526611328
Batch loss: 0.9998540878295898
Batch loss: 0.05216958746314049
Batch loss: 0.9805793762207031
Batch loss: -0.416635125875473
Batch loss: 0.5785304307937622
Batch loss: 0.4393169581890106
Batch loss: 1.1349056959152222
Batch loss: 2.0187039375305176
Batch loss: 0.1380649358034134
Batch loss: 0.2254587709903717
Batch loss: 3.3278558254241943
Batch loss: 0.48757991194725037
Batch loss: -0.10765217989683151
Batch loss: -0.05712871626019478
Batch loss: 1.3657149076461792
Batch loss: 0.28095459938049316
Batch loss: 0.8967432379722595
Traceback (most recent call last):
  File "/home/franlucc/projects/codetrace/train.py", line 284, in <module>
    train_loop(llm)
  File "/home/franlucc/projects/codetrace/train.py", line 205, in train_loop
    causal_loss, _ = apply_mask(llm, output, prompts, correct_idxs, incorrect_idxs)
  File "/home/franlucc/projects/codetrace/train.py", line 80, in apply_mask
    with llm.generate(max_new_tokens=1,
  File "/home/franlucc/venvs/gpu/lib/python3.10/site-packages/nnsight/contexts/Runner.py", line 73, in __exit__
    self.run_local()
  File "/home/franlucc/venvs/gpu/lib/python3.10/site-packages/nnsight/contexts/Runner.py", line 78, in run_local
    self.output = self.model(
  File "/home/franlucc/venvs/gpu/lib/python3.10/site-packages/nnsight/models/NNsightModel.py", line 194, in __call__
    output = fn(inputs, *args, **kwargs)
  File "/home/franlucc/venvs/gpu/lib/python3.10/site-packages/nnsight/models/LanguageModel.py", line 166, in _generation
    return super()._generation(
  File "/home/franlucc/venvs/gpu/lib/python3.10/site-packages/nnsight/models/NNsightModel.py", line 412, in _generation
    return self.local_model.generate(
  File "/home/franlucc/venvs/gpu/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
  File "/home/franlucc/venvs/gpu/lib/python3.10/site-packages/transformers/generation/utils.py", line 1474, in generate
    return self.greedy_search(
  File "/home/franlucc/venvs/gpu/lib/python3.10/site-packages/transformers/generation/utils.py", line 2392, in greedy_search
    if unfinished_sequences.max() == 0:
KeyboardInterrupt