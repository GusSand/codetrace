392
278
Training...
Batch loss: 219.4202880859375
Batch loss: 102.382568359375
Batch loss: 11.047823905944824
Batch loss: 21.42792320251465
Batch loss: 164.31980895996094
Batch loss: 25.29185676574707
Batch loss: 37.28276824951172
Batch loss: 41.098201751708984
Batch loss: 12.711165428161621
Batch loss: 12.266948699951172
Batch loss: 23.01582908630371
Batch loss: 24.656904220581055
Batch loss: 23.23842430114746
Batch loss: 2.6424808502197266
Batch loss: 10.973362922668457
Batch loss: 3.12113618850708
Batch loss: 31.278676986694336
Batch loss: 63.25531768798828
Batch loss: 160.7258758544922
Batch loss: 47.28868103027344
Batch loss: 783.302490234375
Batch loss: 33.94132614135742
Batch loss: 287.43316650390625
Batch loss: 37.152626037597656
Batch loss: 57.18286895751953
Batch loss: 9.939824104309082
Batch loss: 244.2267608642578
Batch loss: 51.88474655151367
Batch loss: 37.09989547729492
Batch loss: 20.20351219177246
Batch loss: 1.1533849239349365
Batch loss: 34.19780349731445
Batch loss: 38.0693359375
Batch loss: 68.4024887084961
Batch loss: 240.57131958007812
Batch loss: 41.53062057495117
Batch loss: 90.66424560546875
Batch loss: 2.3695716857910156
Traceback (most recent call last):
  File "/home/franlucc/projects/codetrace/train.py", line 283, in <module>
    train_loop(llm)
  File "/home/franlucc/projects/codetrace/train.py", line 204, in train_loop
    causal_loss, _ = apply_mask(llm, output, prompts, correct_idxs, incorrect_idxs)
  File "/home/franlucc/projects/codetrace/train.py", line 80, in apply_mask
    with llm.generate(max_new_tokens=1,
  File "/home/franlucc/venvs/gpu/lib/python3.10/site-packages/nnsight/contexts/Runner.py", line 73, in __exit__
    self.run_local()
  File "/home/franlucc/venvs/gpu/lib/python3.10/site-packages/nnsight/contexts/Runner.py", line 78, in run_local
    self.output = self.model(
  File "/home/franlucc/venvs/gpu/lib/python3.10/site-packages/nnsight/models/NNsightModel.py", line 194, in __call__
    output = fn(inputs, *args, **kwargs)
  File "/home/franlucc/venvs/gpu/lib/python3.10/site-packages/nnsight/models/LanguageModel.py", line 166, in _generation
    return super()._generation(
  File "/home/franlucc/venvs/gpu/lib/python3.10/site-packages/nnsight/models/NNsightModel.py", line 412, in _generation
    return self.local_model.generate(
  File "/home/franlucc/venvs/gpu/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
  File "/home/franlucc/venvs/gpu/lib/python3.10/site-packages/transformers/generation/utils.py", line 1474, in generate
    return self.greedy_search(
  File "/home/franlucc/venvs/gpu/lib/python3.10/site-packages/transformers/generation/utils.py", line 2392, in greedy_search
    if unfinished_sequences.max() == 0:
KeyboardInterrupt