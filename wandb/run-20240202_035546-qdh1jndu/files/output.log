264
216
Training...
Batch loss: 0.218418151140213
Batch loss: 0.3959368169307709
Batch loss: 0.636130690574646
Batch loss: 0.333406537771225
Batch loss: 0.42775827646255493
Batch loss: 0.3820328116416931
Batch loss: 0.5577846765518188
Batch loss: 0.37535834312438965
Batch loss: 0.3477207124233246
Batch loss: 0.40390798449516296
Batch loss: 0.2633661925792694
Batch loss: 0.5498741269111633
Batch loss: 0.25924474000930786
Batch loss: 0.3950127959251404
Batch loss: 0.49546948075294495
Batch loss: 0.32883936166763306
Batch loss: 0.3433234691619873
Batch loss: 0.4585590362548828
Batch loss: 0.31834688782691956
Batch loss: 0.6039266586303711
Batch loss: 0.41920533776283264
Batch loss: 0.33341118693351746
Batch loss: 0.36261624097824097
Batch loss: 0.5437524914741516
Batch loss: 0.26602205634117126
Batch loss: 0.21119718253612518
Batch loss: 0.47115346789360046
Batch loss: 0.13008753955364227
Batch loss: 0.6543613076210022
Batch loss: 0.3314010500907898
Batch loss: 0.29745420813560486
Batch loss: 0.1634833663702011
Batch loss: 0.5341341495513916
Batch loss: 0.3813094198703766
Batch loss: 0.1825825572013855
Batch loss: 0.5993470549583435
Batch loss: 0.19895358383655548
Batch loss: 0.5393671989440918
Batch loss: 0.43113550543785095
Batch loss: 0.4451507031917572
Batch loss: 0.625278890132904
Batch loss: 0.5248822569847107
Batch loss: 0.4338246285915375
Traceback (most recent call last):
  File "/home/franlucc/projects/codetrace/train.py", line 269, in <module>
    train_loop(llm)
  File "/home/franlucc/projects/codetrace/train.py", line 194, in train_loop
    causal_loss, _ = apply_mask(llm, output, prompts, correct_idxs, incorrect_idxs)
  File "/home/franlucc/projects/codetrace/train.py", line 79, in apply_mask
    with llm.generate(max_new_tokens=1,
  File "/home/franlucc/venvs/gpu/lib/python3.10/site-packages/nnsight/contexts/Runner.py", line 69, in __exit__
    raise exc_val
  File "/home/franlucc/projects/codetrace/train.py", line 121, in apply_mask
    diff = diff.diag().save()
  File "/home/franlucc/venvs/gpu/lib/python3.10/site-packages/nnsight/tracing/Proxy.py", line 55, in __call__
    return self.node.graph.add(
  File "/home/franlucc/venvs/gpu/lib/python3.10/site-packages/nnsight/tracing/Graph.py", line 219, in add
    value = target(
  File "/home/franlucc/venvs/gpu/lib/python3.10/site-packages/nnsight/tracing/Proxy.py", line 25, in proxy_call
    return callable(*args, **kwargs)
RuntimeError: diag(): Supports 1D or 2D tensors. Got 0D