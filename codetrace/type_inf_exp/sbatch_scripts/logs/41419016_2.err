/work/arjunguha-research-group/franlucc/venvs/v_codetrace/lib/python3.10/site-packages/diffusers/utils/outputs.py:63: UserWarning: torch.utils._pytree._register_pytree_node is deprecated. Please use torch.utils._pytree.register_pytree_node instead.
  torch.utils._pytree._register_pytree_node(
/work/arjunguha-research-group/franlucc/venvs/v_codetrace/lib/python3.10/site-packages/tree_sitter/__init__.py:36: FutureWarning: Language.build_library is deprecated. Use the new bindings instead.
  warn("{} is deprecated. Use {} instead.".format(old, new), FutureWarning)
/work/arjunguha-research-group/franlucc/venvs/v_codetrace/lib/python3.10/site-packages/tree_sitter/__init__.py:36: FutureWarning: Language(path, name) is deprecated. Use Language(ptr, name) instead.
  warn("{} is deprecated. Use {} instead.".format(old, new), FutureWarning)
Batch:   0%|          | 0/334 [00:00<?, ?it/s]Batch:   0%|          | 0/334 [00:00<?, ?it/s]
Traceback (most recent call last):
  File "/work/arjunguha-research-group/franlucc/projects/codetrace/codetrace/type_inf_exp/scripts/steer.py", line 112, in <module>
    make_steering_tensor(args)
  File "/work/arjunguha-research-group/franlucc/projects/codetrace/codetrace/type_inf_exp/scripts/steer.py", line 81, in make_steering_tensor
    diff_tensor = get_steering_tensor(model, correct, incorrect, args)
  File "/work/arjunguha-research-group/franlucc/projects/codetrace/codetrace/type_inf_exp/steering.py", line 214, in get_steering_tensor
    correct_avg_tensor = batched_get_averages(model, 
  File "/work/arjunguha-research-group/franlucc/projects/codetrace/codetrace/type_inf_exp/request_patch.py", line 39, in batched_get_averages
    hs = collect_hidden_states_at_tokens(model, batch, tokens)
  File "/work/arjunguha-research-group/franlucc/projects/codetrace/codetrace/interp_utils.py", line 157, in collect_hidden_states_at_tokens
    with model.forward() as runner:
  File "/work/arjunguha-research-group/franlucc/venvs/v_codetrace/lib/python3.10/site-packages/nnsight/contexts/Runner.py", line 73, in __exit__
    self.run_local()
  File "/work/arjunguha-research-group/franlucc/venvs/v_codetrace/lib/python3.10/site-packages/nnsight/contexts/Runner.py", line 78, in run_local
    self.output = self.model(
  File "/work/arjunguha-research-group/franlucc/venvs/v_codetrace/lib/python3.10/site-packages/nnsight/models/NNsightModel.py", line 163, in __call__
    self.dispatch_local_model()
  File "/work/arjunguha-research-group/franlucc/venvs/v_codetrace/lib/python3.10/site-packages/nnsight/models/NNsightModel.py", line 208, in dispatch_local_model
    self.local_model = self._load_local(
  File "/work/arjunguha-research-group/franlucc/venvs/v_codetrace/lib/python3.10/site-packages/nnsight/models/LanguageModel.py", line 64, in _load_local
    return self.automodel.from_pretrained(
  File "/work/arjunguha-research-group/franlucc/venvs/v_codetrace/lib/python3.10/site-packages/transformers/models/auto/auto_factory.py", line 561, in from_pretrained
    return model_class.from_pretrained(
  File "/work/arjunguha-research-group/franlucc/venvs/v_codetrace/lib/python3.10/site-packages/transformers/modeling_utils.py", line 3502, in from_pretrained
    ) = cls._load_pretrained_model(
  File "/work/arjunguha-research-group/franlucc/venvs/v_codetrace/lib/python3.10/site-packages/transformers/modeling_utils.py", line 3926, in _load_pretrained_model
    new_error_msgs, offload_index, state_dict_index = _load_state_dict_into_meta_model(
  File "/work/arjunguha-research-group/franlucc/venvs/v_codetrace/lib/python3.10/site-packages/transformers/modeling_utils.py", line 805, in _load_state_dict_into_meta_model
    set_module_tensor_to_device(model, param_name, param_device, **set_module_kwargs)
  File "/work/arjunguha-research-group/franlucc/venvs/v_codetrace/lib/python3.10/site-packages/accelerate/utils/modeling.py", line 387, in set_module_tensor_to_device
    new_value = value.to(device)
  File "/work/arjunguha-research-group/franlucc/venvs/v_codetrace/lib/python3.10/site-packages/torch/cuda/__init__.py", line 302, in _lazy_init
    torch._C._cuda_init()
RuntimeError: No CUDA GPUs are available
