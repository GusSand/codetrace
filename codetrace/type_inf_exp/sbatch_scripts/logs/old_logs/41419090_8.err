/work/arjunguha-research-group/franlucc/venvs/v_codetrace/lib/python3.10/site-packages/diffusers/utils/outputs.py:63: UserWarning: torch.utils._pytree._register_pytree_node is deprecated. Please use torch.utils._pytree.register_pytree_node instead.
  torch.utils._pytree._register_pytree_node(
/work/arjunguha-research-group/franlucc/venvs/v_codetrace/lib/python3.10/site-packages/tree_sitter/__init__.py:36: FutureWarning: Language.build_library is deprecated. Use the new bindings instead.
  warn("{} is deprecated. Use {} instead.".format(old, new), FutureWarning)
/work/arjunguha-research-group/franlucc/venvs/v_codetrace/lib/python3.10/site-packages/tree_sitter/__init__.py:36: FutureWarning: Language(path, name) is deprecated. Use Language(ptr, name) instead.
  warn("{} is deprecated. Use {} instead.".format(old, new), FutureWarning)
Batch:   0%|          | 0/1932 [00:00<?, ?it/s]huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
You're using a GPT2TokenizerFast tokenizer. Please note that with a fast tokenizer, using the `__call__` method is faster than using a method to encode the text followed by a call to the `pad` method to get a padded encoding.
Batch:   0%|          | 1/1932 [00:05<3:10:12,  5.91s/it]Batch:   0%|          | 2/1932 [00:09<2:22:11,  4.42s/it]Batch:   0%|          | 3/1932 [00:11<1:55:39,  3.60s/it]Batch:   0%|          | 4/1932 [00:17<2:26:09,  4.55s/it]Batch:   0%|          | 5/1932 [00:23<2:40:39,  5.00s/it]Batch:   0%|          | 6/1932 [00:35<3:52:13,  7.23s/it]Batch:   0%|          | 7/1932 [00:38<3:06:36,  5.82s/it]Batch:   0%|          | 8/1932 [00:41<2:40:52,  5.02s/it]Batch:   0%|          | 9/1932 [00:45<2:32:15,  4.75s/it]Batch:   1%|          | 10/1932 [00:53<3:01:50,  5.68s/it]Batch:   1%|          | 11/1932 [00:55<2:27:47,  4.62s/it]Batch:   1%|          | 12/1932 [01:01<2:44:14,  5.13s/it]Batch:   1%|          | 13/1932 [01:06<2:38:08,  4.94s/it]Batch:   1%|          | 14/1932 [01:14<3:06:37,  5.84s/it]Batch:   1%|          | 15/1932 [01:22<3:33:21,  6.68s/it]Batch:   1%|          | 16/1932 [01:30<3:45:59,  7.08s/it]Batch:   1%|          | 17/1932 [01:38<3:45:56,  7.08s/it]Batch:   1%|          | 18/1932 [01:42<3:25:16,  6.43s/it]Batch:   1%|          | 19/1932 [01:51<3:45:17,  7.07s/it]Batch:   1%|          | 20/1932 [01:59<3:51:02,  7.25s/it]Batch:   1%|          | 21/1932 [02:05<3:42:04,  6.97s/it]Batch:   1%|          | 22/1932 [02:13<3:53:38,  7.34s/it]Batch:   1%|          | 23/1932 [02:16<3:13:09,  6.07s/it]Batch:   1%|          | 24/1932 [02:20<2:52:38,  5.43s/it]Batch:   1%|▏         | 25/1932 [02:28<3:13:38,  6.09s/it]Batch:   1%|▏         | 26/1932 [02:36<3:32:45,  6.70s/it]Batch:   1%|▏         | 27/1932 [02:39<2:56:37,  5.56s/it]Batch:   1%|▏         | 28/1932 [02:43<2:40:19,  5.05s/it]Batch:   2%|▏         | 29/1932 [02:53<3:28:22,  6.57s/it]Batch:   2%|▏         | 30/1932 [02:56<2:56:58,  5.58s/it]Batch:   2%|▏         | 31/1932 [02:59<2:32:32,  4.81s/it]Batch:   2%|▏         | 32/1932 [03:06<2:49:32,  5.35s/it]Batch:   2%|▏         | 33/1932 [03:10<2:43:01,  5.15s/it]Batch:   2%|▏         | 34/1932 [03:13<2:17:10,  4.34s/it]Batch:   2%|▏         | 35/1932 [03:32<4:34:06,  8.67s/it]Batch:   2%|▏         | 36/1932 [03:42<4:53:23,  9.28s/it]Batch:   2%|▏         | 37/1932 [03:51<4:47:07,  9.09s/it]Batch:   2%|▏         | 38/1932 [03:57<4:13:27,  8.03s/it]Batch:   2%|▏         | 39/1932 [04:07<4:36:52,  8.78s/it]Batch:   2%|▏         | 40/1932 [04:16<4:37:17,  8.79s/it]Batch:   2%|▏         | 41/1932 [04:20<3:55:06,  7.46s/it]Batch:   2%|▏         | 42/1932 [04:23<3:13:28,  6.14s/it]Batch:   2%|▏         | 43/1932 [04:29<3:04:05,  5.85s/it]Batch:   2%|▏         | 44/1932 [04:36<3:19:42,  6.35s/it]Batch:   2%|▏         | 45/1932 [04:41<3:04:52,  5.88s/it]Batch:   2%|▏         | 46/1932 [04:47<3:05:11,  5.89s/it]Batch:   2%|▏         | 47/1932 [04:50<2:38:12,  5.04s/it]Batch:   2%|▏         | 48/1932 [04:54<2:29:48,  4.77s/it]Batch:   3%|▎         | 49/1932 [04:59<2:32:07,  4.85s/it]Batch:   3%|▎         | 50/1932 [05:08<3:09:59,  6.06s/it]Batch:   3%|▎         | 51/1932 [05:11<2:41:35,  5.15s/it]Batch:   3%|▎         | 52/1932 [05:21<3:30:21,  6.71s/it]Batch:   3%|▎         | 53/1932 [05:32<4:03:32,  7.78s/it]Batch:   3%|▎         | 54/1932 [05:40<4:06:52,  7.89s/it]Batch:   3%|▎         | 55/1932 [05:49<4:19:24,  8.29s/it]Batch:   3%|▎         | 56/1932 [06:03<5:10:04,  9.92s/it]Batch:   3%|▎         | 57/1932 [06:07<4:16:08,  8.20s/it]Batch:   3%|▎         | 58/1932 [06:09<3:23:13,  6.51s/it]Batch:   3%|▎         | 59/1932 [06:18<3:43:12,  7.15s/it]Batch:   3%|▎         | 60/1932 [06:21<3:06:55,  5.99s/it]Batch:   3%|▎         | 61/1932 [06:25<2:47:25,  5.37s/it]Batch:   3%|▎         | 62/1932 [06:29<2:31:03,  4.85s/it]Batch:   3%|▎         | 63/1932 [06:38<3:07:07,  6.01s/it]Batch:   3%|▎         | 64/1932 [06:42<2:47:54,  5.39s/it]Batch:   3%|▎         | 65/1932 [06:48<2:56:39,  5.68s/it]Batch:   3%|▎         | 66/1932 [06:51<2:36:45,  5.04s/it]Batch:   3%|▎         | 67/1932 [06:56<2:32:35,  4.91s/it]Batch:   4%|▎         | 68/1932 [07:03<2:51:27,  5.52s/it]Batch:   4%|▎         | 69/1932 [07:08<2:45:41,  5.34s/it]Batch:   4%|▎         | 70/1932 [07:13<2:44:50,  5.31s/it]Batch:   4%|▎         | 71/1932 [07:17<2:35:38,  5.02s/it]Batch:   4%|▎         | 72/1932 [07:23<2:39:01,  5.13s/it]Batch:   4%|▍         | 73/1932 [07:28<2:43:03,  5.26s/it]Batch:   4%|▍         | 74/1932 [07:31<2:14:57,  4.36s/it]Batch:   4%|▍         | 75/1932 [07:35<2:11:20,  4.24s/it]Batch:   4%|▍         | 76/1932 [07:39<2:08:44,  4.16s/it]Batch:   4%|▍         | 77/1932 [07:41<1:50:28,  3.57s/it]Batch:   4%|▍         | 78/1932 [07:44<1:45:38,  3.42s/it]Batch:   4%|▍         | 79/1932 [07:48<1:52:31,  3.64s/it]Batch:   4%|▍         | 80/1932 [08:04<3:44:46,  7.28s/it]Batch:   4%|▍         | 81/1932 [08:08<3:17:15,  6.39s/it]Batch:   4%|▍         | 82/1932 [08:14<3:16:40,  6.38s/it]Batch:   4%|▍         | 83/1932 [08:26<4:04:40,  7.94s/it]Batch:   4%|▍         | 84/1932 [08:29<3:22:43,  6.58s/it]Batch:   4%|▍         | 85/1932 [08:44<4:34:42,  8.92s/it]Batch:   4%|▍         | 86/1932 [08:48<3:48:44,  7.43s/it]Batch:   5%|▍         | 87/1932 [08:53<3:29:03,  6.80s/it]Batch:   5%|▍         | 88/1932 [09:00<3:29:24,  6.81s/it]Batch:   5%|▍         | 89/1932 [09:06<3:17:55,  6.44s/it]Batch:   5%|▍         | 90/1932 [09:11<3:03:59,  5.99s/it]Batch:   5%|▍         | 91/1932 [09:13<2:32:05,  4.96s/it]Batch:   5%|▍         | 92/1932 [09:23<3:21:08,  6.56s/it]Batch:   5%|▍         | 93/1932 [09:31<3:33:41,  6.97s/it]Batch:   5%|▍         | 94/1932 [09:39<3:41:40,  7.24s/it]Batch:   5%|▍         | 95/1932 [09:44<3:16:08,  6.41s/it]Batch:   5%|▍         | 96/1932 [09:47<2:52:00,  5.62s/it]Batch:   5%|▌         | 97/1932 [09:56<3:22:14,  6.61s/it]Batch:   5%|▌         | 98/1932 [10:03<3:26:27,  6.75s/it]Batch:   5%|▌         | 99/1932 [10:11<3:31:14,  6.91s/it]Batch:   5%|▌         | 100/1932 [10:21<4:02:26,  7.94s/it]Batch:   5%|▌         | 101/1932 [10:37<5:12:58, 10.26s/it]Batch:   5%|▌         | 102/1932 [10:51<5:47:27, 11.39s/it]Batch:   5%|▌         | 103/1932 [10:54<4:36:13,  9.06s/it]Batch:   5%|▌         | 104/1932 [11:05<4:47:33,  9.44s/it]Batch:   5%|▌         | 105/1932 [11:14<4:49:56,  9.52s/it]Batch:   5%|▌         | 106/1932 [11:19<4:02:02,  7.95s/it]Batch:   6%|▌         | 107/1932 [11:23<3:28:31,  6.86s/it]Batch:   6%|▌         | 108/1932 [11:34<4:02:50,  7.99s/it]Batch:   6%|▌         | 109/1932 [11:39<3:37:36,  7.16s/it]Batch:   6%|▌         | 110/1932 [11:46<3:33:28,  7.03s/it]Batch:   6%|▌         | 111/1932 [11:52<3:30:34,  6.94s/it]Batch:   6%|▌         | 112/1932 [11:58<3:19:18,  6.57s/it]Batch:   6%|▌         | 113/1932 [12:05<3:22:34,  6.68s/it]Batch:   6%|▌         | 114/1932 [12:09<2:59:01,  5.91s/it]Batch:   6%|▌         | 115/1932 [12:14<2:52:32,  5.70s/it]Batch:   6%|▌         | 116/1932 [12:17<2:23:11,  4.73s/it]Batch:   6%|▌         | 117/1932 [12:22<2:24:02,  4.76s/it]Batch:   6%|▌         | 118/1932 [12:25<2:14:51,  4.46s/it]Batch:   6%|▌         | 119/1932 [12:28<1:59:30,  3.95s/it]Batch:   6%|▌         | 120/1932 [12:33<2:09:58,  4.30s/it]Batch:   6%|▋         | 121/1932 [12:37<2:07:03,  4.21s/it]Batch:   6%|▋         | 122/1932 [12:42<2:10:09,  4.31s/it]Batch:   6%|▋         | 123/1932 [12:46<2:10:29,  4.33s/it]Batch:   6%|▋         | 124/1932 [12:50<2:06:32,  4.20s/it]Batch:   6%|▋         | 125/1932 [13:05<3:39:59,  7.30s/it]Batch:   7%|▋         | 126/1932 [13:08<3:01:37,  6.03s/it]Batch:   7%|▋         | 127/1932 [13:11<2:39:09,  5.29s/it]Batch:   7%|▋         | 128/1932 [13:25<3:52:12,  7.72s/it]Batch:   7%|▋         | 129/1932 [13:29<3:24:23,  6.80s/it]Batch:   7%|▋         | 130/1932 [13:32<2:48:27,  5.61s/it]Batch:   7%|▋         | 131/1932 [13:36<2:36:41,  5.22s/it]Batch:   7%|▋         | 132/1932 [13:43<2:46:40,  5.56s/it]Batch:   7%|▋         | 133/1932 [13:46<2:26:44,  4.89s/it]Batch:   7%|▋         | 134/1932 [13:50<2:19:55,  4.67s/it]Batch:   7%|▋         | 135/1932 [13:54<2:15:31,  4.52s/it]Batch:   7%|▋         | 136/1932 [13:58<2:10:38,  4.36s/it]Batch:   7%|▋         | 137/1932 [14:02<2:06:43,  4.24s/it]Batch:   7%|▋         | 138/1932 [14:06<2:03:54,  4.14s/it]Batch:   7%|▋         | 139/1932 [14:09<1:55:41,  3.87s/it]Batch:   7%|▋         | 140/1932 [14:26<3:48:39,  7.66s/it]Batch:   7%|▋         | 141/1932 [14:29<3:07:59,  6.30s/it]Batch:   7%|▋         | 142/1932 [14:34<2:51:12,  5.74s/it]Batch:   7%|▋         | 143/1932 [14:38<2:39:52,  5.36s/it]Batch:   7%|▋         | 144/1932 [14:43<2:34:01,  5.17s/it]Batch:   8%|▊         | 145/1932 [14:47<2:26:37,  4.92s/it]Batch:   8%|▊         | 146/1932 [14:58<3:18:18,  6.66s/it]Batch:   8%|▊         | 147/1932 [15:05<3:18:30,  6.67s/it]Batch:   8%|▊         | 148/1932 [15:11<3:18:21,  6.67s/it]Batch:   8%|▊         | 149/1932 [15:14<2:41:23,  5.43s/it]Batch:   8%|▊         | 150/1932 [15:17<2:21:52,  4.78s/it]Batch:   8%|▊         | 151/1932 [15:27<3:08:41,  6.36s/it]Batch:   8%|▊         | 152/1932 [15:33<3:00:59,  6.10s/it]Batch:   8%|▊         | 153/1932 [15:36<2:36:47,  5.29s/it]Batch:   8%|▊         | 154/1932 [15:40<2:30:05,  5.06s/it]Batch:   8%|▊         | 155/1932 [15:47<2:41:31,  5.45s/it]Batch:   8%|▊         | 156/1932 [15:53<2:48:34,  5.69s/it]Batch:   8%|▊         | 157/1932 [15:57<2:29:58,  5.07s/it]Batch:   8%|▊         | 158/1932 [16:00<2:11:29,  4.45s/it]Batch:   8%|▊         | 159/1932 [16:07<2:37:07,  5.32s/it]Batch:   8%|▊         | 160/1932 [16:10<2:19:11,  4.71s/it]Batch:   8%|▊         | 161/1932 [16:31<4:39:11,  9.46s/it]Batch:   8%|▊         | 162/1932 [16:37<4:12:37,  8.56s/it]Batch:   8%|▊         | 163/1932 [16:41<3:26:40,  7.01s/it]Batch:   8%|▊         | 164/1932 [16:44<2:52:56,  5.87s/it]Batch:   9%|▊         | 165/1932 [16:48<2:36:03,  5.30s/it]Batch:   9%|▊         | 166/1932 [16:59<3:30:32,  7.15s/it]Batch:   9%|▊         | 167/1932 [17:04<3:10:49,  6.49s/it]Batch:   9%|▊         | 168/1932 [17:10<3:00:50,  6.15s/it]Batch:   9%|▊         | 169/1932 [17:16<2:58:56,  6.09s/it]Batch:   9%|▉         | 170/1932 [17:25<3:30:37,  7.17s/it]Batch:   9%|▉         | 171/1932 [17:38<4:16:38,  8.74s/it]Batch:   9%|▉         | 172/1932 [17:43<3:42:30,  7.59s/it]Batch:   9%|▉         | 173/1932 [17:47<3:17:34,  6.74s/it]Batch:   9%|▉         | 174/1932 [17:51<2:52:11,  5.88s/it]Batch:   9%|▉         | 175/1932 [17:56<2:41:25,  5.51s/it]Batch:   9%|▉         | 176/1932 [18:01<2:33:28,  5.24s/it]Batch:   9%|▉         | 177/1932 [18:10<3:07:10,  6.40s/it]Batch:   9%|▉         | 178/1932 [18:17<3:18:11,  6.78s/it]Batch:   9%|▉         | 179/1932 [18:21<2:47:04,  5.72s/it]Batch:   9%|▉         | 180/1932 [18:38<4:26:18,  9.12s/it]Batch:   9%|▉         | 181/1932 [18:41<3:40:06,  7.54s/it]Batch:   9%|▉         | 182/1932 [18:46<3:14:33,  6.67s/it]Batch:   9%|▉         | 183/1932 [18:49<2:44:50,  5.65s/it]Batch:  10%|▉         | 184/1932 [18:54<2:32:00,  5.22s/it]Batch:  10%|▉         | 185/1932 [19:00<2:46:41,  5.72s/it]Batch:  10%|▉         | 186/1932 [19:04<2:26:56,  5.05s/it]Batch:  10%|▉         | 187/1932 [19:07<2:12:49,  4.57s/it]Batch:  10%|▉         | 188/1932 [19:16<2:46:11,  5.72s/it]Batch:  10%|▉         | 189/1932 [19:18<2:18:31,  4.77s/it]Batch:  10%|▉         | 190/1932 [19:30<3:15:45,  6.74s/it]Batch:  10%|▉         | 191/1932 [19:35<3:00:06,  6.21s/it]Batch:  10%|▉         | 192/1932 [19:41<3:03:13,  6.32s/it]Batch:  10%|▉         | 193/1932 [19:48<3:11:10,  6.60s/it]Batch:  10%|█         | 194/1932 [19:52<2:41:59,  5.59s/it]Batch:  10%|█         | 195/1932 [19:55<2:19:58,  4.84s/it]Batch:  10%|█         | 196/1932 [20:05<3:06:40,  6.45s/it]Batch:  10%|█         | 197/1932 [20:08<2:35:42,  5.38s/it]Batch:  10%|█         | 198/1932 [20:15<2:47:52,  5.81s/it]Batch:  10%|█         | 199/1932 [20:18<2:27:14,  5.10s/it]Batch:  10%|█         | 200/1932 [20:22<2:19:44,  4.84s/it]Batch:  10%|█         | 201/1932 [20:29<2:30:41,  5.22s/it]Batch:  10%|█         | 202/1932 [20:35<2:39:08,  5.52s/it]Batch:  11%|█         | 203/1932 [20:37<2:14:59,  4.68s/it]Batch:  11%|█         | 204/1932 [20:45<2:41:31,  5.61s/it]Batch:  11%|█         | 205/1932 [20:52<2:54:52,  6.08s/it]Batch:  11%|█         | 206/1932 [21:00<3:10:51,  6.63s/it]Batch:  11%|█         | 207/1932 [21:13<4:03:34,  8.47s/it]Batch:  11%|█         | 208/1932 [21:21<4:00:48,  8.38s/it]Batch:  11%|█         | 209/1932 [21:26<3:27:48,  7.24s/it]Batch:  11%|█         | 210/1932 [21:35<3:47:59,  7.94s/it]Batch:  11%|█         | 211/1932 [21:39<3:10:24,  6.64s/it]Batch:  11%|█         | 212/1932 [21:42<2:41:30,  5.63s/it]Batch:  11%|█         | 213/1932 [21:46<2:25:30,  5.08s/it]Batch:  11%|█         | 214/1932 [21:49<2:04:36,  4.35s/it]Batch:  11%|█         | 215/1932 [21:59<2:57:21,  6.20s/it]Batch:  11%|█         | 216/1932 [22:10<3:35:01,  7.52s/it]Batch:  11%|█         | 217/1932 [22:23<4:23:33,  9.22s/it]Batch:  11%|█▏        | 218/1932 [22:29<3:55:00,  8.23s/it]Batch:  11%|█▏        | 219/1932 [22:34<3:24:21,  7.16s/it]Batch:  11%|█▏        | 220/1932 [22:45<3:59:14,  8.38s/it]Batch:  11%|█▏        | 221/1932 [22:49<3:19:22,  6.99s/it]Batch:  11%|█▏        | 222/1932 [22:51<2:40:21,  5.63s/it]Batch:  12%|█▏        | 223/1932 [22:54<2:19:38,  4.90s/it]Batch:  12%|█▏        | 224/1932 [23:00<2:25:11,  5.10s/it]Batch:  12%|█▏        | 225/1932 [23:06<2:38:01,  5.55s/it]Batch:  12%|█▏        | 226/1932 [23:10<2:21:55,  4.99s/it]Batch:  12%|█▏        | 227/1932 [23:13<2:06:29,  4.45s/it]Batch:  12%|█▏        | 228/1932 [23:18<2:04:45,  4.39s/it]Batch:  12%|█▏        | 229/1932 [23:27<2:50:49,  6.02s/it]Batch:  12%|█▏        | 230/1932 [23:34<2:56:00,  6.20s/it]Batch:  12%|█▏        | 231/1932 [23:43<3:18:34,  7.00s/it]Batch:  12%|█▏        | 232/1932 [23:49<3:10:24,  6.72s/it]Batch:  12%|█▏        | 233/1932 [23:55<3:04:02,  6.50s/it]Batch:  12%|█▏        | 234/1932 [24:07<3:54:15,  8.28s/it]Batch:  12%|█▏        | 235/1932 [24:10<3:07:44,  6.64s/it]Batch:  12%|█▏        | 236/1932 [24:21<3:46:52,  8.03s/it]Batch:  12%|█▏        | 237/1932 [24:26<3:15:08,  6.91s/it]Batch:  12%|█▏        | 238/1932 [24:35<3:37:07,  7.69s/it]Batch:  12%|█▏        | 239/1932 [24:40<3:15:43,  6.94s/it]Batch:  12%|█▏        | 240/1932 [24:43<2:42:02,  5.75s/it]Batch:  12%|█▏        | 241/1932 [24:51<3:00:32,  6.41s/it]Batch:  13%|█▎        | 242/1932 [24:59<3:14:13,  6.90s/it]Batch:  13%|█▎        | 243/1932 [25:04<2:55:57,  6.25s/it]Batch:  13%|█▎        | 244/1932 [25:08<2:36:09,  5.55s/it]Batch:  13%|█▎        | 245/1932 [25:12<2:22:31,  5.07s/it]Batch:  13%|█▎        | 246/1932 [25:16<2:13:37,  4.76s/it]Batch:  13%|█▎        | 247/1932 [25:21<2:12:59,  4.74s/it]Batch:  13%|█▎        | 248/1932 [25:28<2:34:18,  5.50s/it]Batch:  13%|█▎        | 249/1932 [25:33<2:27:26,  5.26s/it]Batch:  13%|█▎        | 250/1932 [25:36<2:08:23,  4.58s/it]Batch:  13%|█▎        | 251/1932 [25:40<2:05:20,  4.47s/it]Batch:  13%|█▎        | 252/1932 [25:54<3:29:44,  7.49s/it]Batch:  13%|█▎        | 253/1932 [26:00<3:11:20,  6.84s/it]Batch:  13%|█▎        | 254/1932 [26:03<2:42:31,  5.81s/it]Batch:  13%|█▎        | 255/1932 [26:06<2:16:52,  4.90s/it]Batch:  13%|█▎        | 256/1932 [26:10<2:11:52,  4.72s/it]Batch:  13%|█▎        | 257/1932 [26:15<2:08:32,  4.60s/it]Batch:  13%|█▎        | 258/1932 [26:22<2:32:15,  5.46s/it]Batch:  13%|█▎        | 259/1932 [26:29<2:47:30,  6.01s/it]Batch:  13%|█▎        | 260/1932 [26:37<2:57:47,  6.38s/it]Batch:  14%|█▎        | 261/1932 [26:41<2:44:29,  5.91s/it]Batch:  14%|█▎        | 262/1932 [26:55<3:48:59,  8.23s/it]Batch:  14%|█▎        | 263/1932 [27:09<4:34:16,  9.86s/it]Batch:  14%|█▎        | 264/1932 [27:12<3:40:53,  7.95s/it]Batch:  14%|█▎        | 265/1932 [27:28<4:48:02, 10.37s/it]Batch:  14%|█▍        | 266/1932 [27:31<3:46:05,  8.14s/it]Batch:  14%|█▍        | 267/1932 [27:42<4:12:14,  9.09s/it]Batch:  14%|█▍        | 268/1932 [27:49<3:53:54,  8.43s/it]Batch:  14%|█▍        | 269/1932 [27:52<3:06:54,  6.74s/it]Batch:  14%|█▍        | 270/1932 [28:17<5:37:53, 12.20s/it]Batch:  14%|█▍        | 271/1932 [28:25<5:04:40, 11.01s/it]Batch:  14%|█▍        | 272/1932 [28:29<4:05:19,  8.87s/it]Batch:  14%|█▍        | 273/1932 [28:32<3:17:33,  7.14s/it]Batch:  14%|█▍        | 274/1932 [28:37<2:54:14,  6.31s/it]Batch:  14%|█▍        | 275/1932 [28:39<2:22:21,  5.15s/it]Batch:  14%|█▍        | 276/1932 [28:45<2:30:58,  5.47s/it]Batch:  14%|█▍        | 277/1932 [28:55<3:08:05,  6.82s/it]Batch:  14%|█▍        | 278/1932 [29:07<3:47:50,  8.27s/it]Batch:  14%|█▍        | 279/1932 [29:18<4:14:09,  9.23s/it]Batch:  14%|█▍        | 280/1932 [29:35<5:12:36, 11.35s/it]Batch:  15%|█▍        | 281/1932 [29:47<5:21:04, 11.67s/it]Batch:  15%|█▍        | 282/1932 [29:54<4:43:43, 10.32s/it]Batch:  15%|█▍        | 283/1932 [30:03<4:31:13,  9.87s/it]Batch:  15%|█▍        | 284/1932 [30:07<3:42:04,  8.09s/it]Batch:  15%|█▍        | 285/1932 [30:14<3:35:38,  7.86s/it]Batch:  15%|█▍        | 286/1932 [30:24<3:48:59,  8.35s/it]Batch:  15%|█▍        | 287/1932 [30:33<3:57:25,  8.66s/it]Batch:  15%|█▍        | 288/1932 [30:37<3:13:48,  7.07s/it]Batch:  15%|█▍        | 289/1932 [30:46<3:36:44,  7.92s/it]Batch:  15%|█▌        | 290/1932 [30:52<3:17:27,  7.22s/it]Batch:  15%|█▌        | 291/1932 [30:59<3:12:53,  7.05s/it]Batch:  15%|█▌        | 292/1932 [31:03<2:50:38,  6.24s/it]Batch:  15%|█▌        | 293/1932 [31:13<3:22:13,  7.40s/it]Batch:  15%|█▌        | 294/1932 [31:19<3:09:53,  6.96s/it]Batch:  15%|█▌        | 295/1932 [31:23<2:41:41,  5.93s/it]Batch:  15%|█▌        | 296/1932 [31:26<2:23:15,  5.25s/it]Batch:  15%|█▌        | 297/1932 [31:29<2:04:48,  4.58s/it]Batch:  15%|█▌        | 298/1932 [31:32<1:52:52,  4.14s/it]Batch:  15%|█▌        | 299/1932 [31:36<1:44:21,  3.83s/it]Batch:  16%|█▌        | 300/1932 [31:39<1:45:00,  3.86s/it]Batch:  16%|█▌        | 301/1932 [31:44<1:52:48,  4.15s/it]Batch:  16%|█▌        | 302/1932 [31:47<1:41:56,  3.75s/it]Batch:  16%|█▌        | 303/1932 [31:51<1:41:54,  3.75s/it]Batch:  16%|█▌        | 304/1932 [31:54<1:36:45,  3.57s/it]Batch:  16%|█▌        | 305/1932 [32:03<2:25:09,  5.35s/it]Batch:  16%|█▌        | 306/1932 [32:06<2:01:13,  4.47s/it]Batch:  16%|█▌        | 307/1932 [32:09<1:53:08,  4.18s/it]Batch:  16%|█▌        | 308/1932 [32:16<2:11:21,  4.85s/it]Batch:  16%|█▌        | 309/1932 [32:22<2:23:12,  5.29s/it]Batch:  16%|█▌        | 310/1932 [32:37<3:36:41,  8.02s/it]Batch:  16%|█▌        | 311/1932 [32:42<3:12:04,  7.11s/it]Batch:  16%|█▌        | 312/1932 [32:46<2:54:34,  6.47s/it]Batch:  16%|█▌        | 313/1932 [32:57<3:25:27,  7.61s/it]Batch:  16%|█▋        | 314/1932 [33:03<3:18:03,  7.34s/it]Batch:  16%|█▋        | 315/1932 [33:10<3:08:23,  6.99s/it]Batch:  16%|█▋        | 316/1932 [33:16<3:06:56,  6.94s/it]Batch:  16%|█▋        | 317/1932 [33:20<2:41:59,  6.02s/it]Batch:  16%|█▋        | 318/1932 [33:34<3:40:28,  8.20s/it]Batch:  17%|█▋        | 319/1932 [33:47<4:21:15,  9.72s/it]Batch:  17%|█▋        | 320/1932 [33:53<3:51:20,  8.61s/it]Batch:  17%|█▋        | 321/1932 [34:00<3:35:32,  8.03s/it]Batch:  17%|█▋        | 322/1932 [34:05<3:11:49,  7.15s/it]Batch:  17%|█▋        | 322/1932 [34:11<2:50:56,  6.37s/it]
Traceback (most recent call last):
  File "/work/arjunguha-research-group/franlucc/projects/codetrace/codetrace/type_inf_exp/scripts/steer.py", line 112, in <module>
    make_steering_tensor(args)
  File "/work/arjunguha-research-group/franlucc/projects/codetrace/codetrace/type_inf_exp/scripts/steer.py", line 81, in make_steering_tensor
    diff_tensor = get_steering_tensor(model, correct, incorrect, args)
  File "/work/arjunguha-research-group/franlucc/projects/codetrace/codetrace/type_inf_exp/steering.py", line 214, in get_steering_tensor
    correct_avg_tensor = batched_get_averages(model, 
  File "/work/arjunguha-research-group/franlucc/projects/codetrace/codetrace/type_inf_exp/request_patch.py", line 39, in batched_get_averages
    hs = collect_hidden_states_at_tokens(model, batch, tokens)
  File "/work/arjunguha-research-group/franlucc/projects/codetrace/codetrace/interp_utils.py", line 157, in collect_hidden_states_at_tokens
    with model.forward() as runner:
  File "/work/arjunguha-research-group/franlucc/venvs/v_codetrace/lib/python3.10/site-packages/nnsight/contexts/Runner.py", line 73, in __exit__
    self.run_local()
  File "/work/arjunguha-research-group/franlucc/venvs/v_codetrace/lib/python3.10/site-packages/nnsight/contexts/Runner.py", line 78, in run_local
    self.output = self.model(
  File "/work/arjunguha-research-group/franlucc/venvs/v_codetrace/lib/python3.10/site-packages/nnsight/models/NNsightModel.py", line 194, in __call__
    output = fn(inputs, *args, **kwargs)
  File "/work/arjunguha-research-group/franlucc/venvs/v_codetrace/lib/python3.10/site-packages/nnsight/models/NNsightModel.py", line 398, in _forward
    return self.local_model(
  File "/work/arjunguha-research-group/franlucc/venvs/v_codetrace/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/work/arjunguha-research-group/franlucc/venvs/v_codetrace/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1561, in _call_impl
    result = forward_call(*args, **kwargs)
  File "/work/arjunguha-research-group/franlucc/venvs/v_codetrace/lib/python3.10/site-packages/transformers/models/gpt_bigcode/modeling_gpt_bigcode.py", line 1268, in forward
    transformer_outputs = self.transformer(
  File "/work/arjunguha-research-group/franlucc/venvs/v_codetrace/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/work/arjunguha-research-group/franlucc/venvs/v_codetrace/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
  File "/work/arjunguha-research-group/franlucc/venvs/v_codetrace/lib/python3.10/site-packages/transformers/models/gpt_bigcode/modeling_gpt_bigcode.py", line 1121, in forward
    outputs = block(
  File "/work/arjunguha-research-group/franlucc/venvs/v_codetrace/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/work/arjunguha-research-group/franlucc/venvs/v_codetrace/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1561, in _call_impl
    result = forward_call(*args, **kwargs)
  File "/work/arjunguha-research-group/franlucc/venvs/v_codetrace/lib/python3.10/site-packages/transformers/models/gpt_bigcode/modeling_gpt_bigcode.py", line 728, in forward
    attn_outputs = self.attn(
  File "/work/arjunguha-research-group/franlucc/venvs/v_codetrace/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1511, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/work/arjunguha-research-group/franlucc/venvs/v_codetrace/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1520, in _call_impl
    return forward_call(*args, **kwargs)
  File "/work/arjunguha-research-group/franlucc/venvs/v_codetrace/lib/python3.10/site-packages/transformers/models/gpt_bigcode/modeling_gpt_bigcode.py", line 637, in forward
    attn_output, attn_weights = self._attn(query, key, value, attention_mask, head_mask)
  File "/work/arjunguha-research-group/franlucc/venvs/v_codetrace/lib/python3.10/site-packages/transformers/models/gpt_bigcode/modeling_gpt_bigcode.py", line 569, in _attn
    sdpa_result = torch.nn.functional.scaled_dot_product_attention(
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 23.07 GiB. GPU 0 has a total capacity of 79.15 GiB of which 9.30 GiB is free. Including non-PyTorch memory, this process has 69.83 GiB memory in use. Of the allocated memory 44.35 GiB is allocated by PyTorch, and 25.00 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
