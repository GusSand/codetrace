{
  "experiment_id": "20250724_231254",
  "config": {
    "model_name": "Qwen/Qwen2.5-14B-Instruct",
    "device": "auto",
    "max_new_tokens": 50,
    "temperature": 0.1,
    "steering_strength": 5.0,
    "steering_layers": [
      20,
      35,
      47
    ],
    "results_dir": "results_fixed_full_generation",
    "max_examples_per_type": 3
  },
  "experiment_type": "FIXED_FULL_TEXT_GENERATION",
  "fixes_applied": [
    "Full text generation instead of single token",
    "Proper steering application during generation",
    "Complete response evaluation",
    "Multi-layer steering like successful experiments",
    "Normalized steering vectors",
    "Higher steering strength"
  ],
  "success_summary": {
    "successful_cwes": 8,
    "total_cwes": 8,
    "success_rate": 1.0
  },
  "duration_seconds": 210.44602513313293,
  "overall_metrics": {
    "baseline_accuracy": 0.5,
    "steered_accuracy": 0.5,
    "average_improvement": 0.0,
    "improvement_rate": 0.0,
    "total_examples": 48,
    "cwes_tested": 8
  },
  "cwe_results": {
    "CWE-190": {
      "baseline_accuracy": 0.5,
      "steered_accuracy": 0.5,
      "average_improvement": 0.0,
      "baseline_confidence": 0.5,
      "steered_confidence": 0.5,
      "positive_improvements": 0,
      "negative_improvements": 0,
      "no_change": 6,
      "total_examples": 6,
      "detailed_results": {
        "baseline_correct": 3,
        "steered_correct": 3,
        "total_examples": 6,
        "improvements": [
          0,
          0,
          0,
          0,
          0,
          0
        ],
        "examples": [
          {
            "filename": "1.c",
            "expected_vulnerable": true,
            "baseline_response": "ERROR_BASELINE_GENERATION",
            "steered_response": "ERROR_STEERED_GENERATION",
            "baseline_correct": false,
            "steered_correct": false,
            "baseline_confidence": 0.5,
            "steered_confidence": 0.5,
            "improvement": 0
          },
          {
            "filename": "2.c",
            "expected_vulnerable": true,
            "baseline_response": "ERROR_BASELINE_GENERATION",
            "steered_response": "ERROR_STEERED_GENERATION",
            "baseline_correct": false,
            "steered_correct": false,
            "baseline_confidence": 0.5,
            "steered_confidence": 0.5,
            "improvement": 0
          },
          {
            "filename": "3.c",
            "expected_vulnerable": true,
            "baseline_response": "ERROR_BASELINE_GENERATION",
            "steered_response": "ERROR_STEERED_GENERATION",
            "baseline_correct": false,
            "steered_correct": false,
            "baseline_confidence": 0.5,
            "steered_confidence": 0.5,
            "improvement": 0
          },
          {
            "filename": "p_1.c",
            "expected_vulnerable": false,
            "baseline_response": "ERROR_BASELINE_GENERATION",
            "steered_response": "ERROR_STEERED_GENERATION",
            "baseline_correct": true,
            "steered_correct": true,
            "baseline_confidence": 0.5,
            "steered_confidence": 0.5,
            "improvement": 0
          },
          {
            "filename": "p_2.c",
            "expected_vulnerable": false,
            "baseline_response": "ERROR_BASELINE_GENERATION",
            "steered_response": "ERROR_STEERED_GENERATION",
            "baseline_correct": true,
            "steered_correct": true,
            "baseline_confidence": 0.5,
            "steered_confidence": 0.5,
            "improvement": 0
          },
          {
            "filename": "p_3.c",
            "expected_vulnerable": false,
            "baseline_response": "ERROR_BASELINE_GENERATION",
            "steered_response": "ERROR_STEERED_GENERATION",
            "baseline_correct": true,
            "steered_correct": true,
            "baseline_confidence": 0.5,
            "steered_confidence": 0.5,
            "improvement": 0
          }
        ],
        "baseline_confidence": [
          0.5,
          0.5,
          0.5,
          0.5,
          0.5,
          0.5
        ],
        "steered_confidence": [
          0.5,
          0.5,
          0.5,
          0.5,
          0.5,
          0.5
        ]
      }
    },
    "CWE-22": {
      "baseline_accuracy": 0.5,
      "steered_accuracy": 0.5,
      "average_improvement": 0.0,
      "baseline_confidence": 0.5,
      "steered_confidence": 0.5,
      "positive_improvements": 0,
      "negative_improvements": 0,
      "no_change": 6,
      "total_examples": 6,
      "detailed_results": {
        "baseline_correct": 3,
        "steered_correct": 3,
        "total_examples": 6,
        "improvements": [
          0,
          0,
          0,
          0,
          0,
          0
        ],
        "examples": [
          {
            "filename": "1.c",
            "expected_vulnerable": true,
            "baseline_response": "ERROR_BASELINE_GENERATION",
            "steered_response": "ERROR_STEERED_GENERATION",
            "baseline_correct": false,
            "steered_correct": false,
            "baseline_confidence": 0.5,
            "steered_confidence": 0.5,
            "improvement": 0
          },
          {
            "filename": "2.c",
            "expected_vulnerable": true,
            "baseline_response": "ERROR_BASELINE_GENERATION",
            "steered_response": "ERROR_STEERED_GENERATION",
            "baseline_correct": false,
            "steered_correct": false,
            "baseline_confidence": 0.5,
            "steered_confidence": 0.5,
            "improvement": 0
          },
          {
            "filename": "3.c",
            "expected_vulnerable": true,
            "baseline_response": "ERROR_BASELINE_GENERATION",
            "steered_response": "ERROR_STEERED_GENERATION",
            "baseline_correct": false,
            "steered_correct": false,
            "baseline_confidence": 0.5,
            "steered_confidence": 0.5,
            "improvement": 0
          },
          {
            "filename": "p_1.c",
            "expected_vulnerable": false,
            "baseline_response": "ERROR_BASELINE_GENERATION",
            "steered_response": "ERROR_STEERED_GENERATION",
            "baseline_correct": true,
            "steered_correct": true,
            "baseline_confidence": 0.5,
            "steered_confidence": 0.5,
            "improvement": 0
          },
          {
            "filename": "p_2.c",
            "expected_vulnerable": false,
            "baseline_response": "ERROR_BASELINE_GENERATION",
            "steered_response": "ERROR_STEERED_GENERATION",
            "baseline_correct": true,
            "steered_correct": true,
            "baseline_confidence": 0.5,
            "steered_confidence": 0.5,
            "improvement": 0
          },
          {
            "filename": "p_3.c",
            "expected_vulnerable": false,
            "baseline_response": "ERROR_BASELINE_GENERATION",
            "steered_response": "ERROR_STEERED_GENERATION",
            "baseline_correct": true,
            "steered_correct": true,
            "baseline_confidence": 0.5,
            "steered_confidence": 0.5,
            "improvement": 0
          }
        ],
        "baseline_confidence": [
          0.5,
          0.5,
          0.5,
          0.5,
          0.5,
          0.5
        ],
        "steered_confidence": [
          0.5,
          0.5,
          0.5,
          0.5,
          0.5,
          0.5
        ]
      }
    },
    "CWE-416": {
      "baseline_accuracy": 0.5,
      "steered_accuracy": 0.5,
      "average_improvement": 0.0,
      "baseline_confidence": 0.5,
      "steered_confidence": 0.5,
      "positive_improvements": 0,
      "negative_improvements": 0,
      "no_change": 6,
      "total_examples": 6,
      "detailed_results": {
        "baseline_correct": 3,
        "steered_correct": 3,
        "total_examples": 6,
        "improvements": [
          0,
          0,
          0,
          0,
          0,
          0
        ],
        "examples": [
          {
            "filename": "1.c",
            "expected_vulnerable": true,
            "baseline_response": "ERROR_BASELINE_GENERATION",
            "steered_response": "ERROR_STEERED_GENERATION",
            "baseline_correct": false,
            "steered_correct": false,
            "baseline_confidence": 0.5,
            "steered_confidence": 0.5,
            "improvement": 0
          },
          {
            "filename": "2.c",
            "expected_vulnerable": true,
            "baseline_response": "ERROR_BASELINE_GENERATION",
            "steered_response": "ERROR_STEERED_GENERATION",
            "baseline_correct": false,
            "steered_correct": false,
            "baseline_confidence": 0.5,
            "steered_confidence": 0.5,
            "improvement": 0
          },
          {
            "filename": "3.c",
            "expected_vulnerable": true,
            "baseline_response": "ERROR_BASELINE_GENERATION",
            "steered_response": "ERROR_STEERED_GENERATION",
            "baseline_correct": false,
            "steered_correct": false,
            "baseline_confidence": 0.5,
            "steered_confidence": 0.5,
            "improvement": 0
          },
          {
            "filename": "p_1.c",
            "expected_vulnerable": false,
            "baseline_response": "ERROR_BASELINE_GENERATION",
            "steered_response": "ERROR_STEERED_GENERATION",
            "baseline_correct": true,
            "steered_correct": true,
            "baseline_confidence": 0.5,
            "steered_confidence": 0.5,
            "improvement": 0
          },
          {
            "filename": "p_2.c",
            "expected_vulnerable": false,
            "baseline_response": "ERROR_BASELINE_GENERATION",
            "steered_response": "ERROR_STEERED_GENERATION",
            "baseline_correct": true,
            "steered_correct": true,
            "baseline_confidence": 0.5,
            "steered_confidence": 0.5,
            "improvement": 0
          },
          {
            "filename": "p_3.c",
            "expected_vulnerable": false,
            "baseline_response": "ERROR_BASELINE_GENERATION",
            "steered_response": "ERROR_STEERED_GENERATION",
            "baseline_correct": true,
            "steered_correct": true,
            "baseline_confidence": 0.5,
            "steered_confidence": 0.5,
            "improvement": 0
          }
        ],
        "baseline_confidence": [
          0.5,
          0.5,
          0.5,
          0.5,
          0.5,
          0.5
        ],
        "steered_confidence": [
          0.5,
          0.5,
          0.5,
          0.5,
          0.5,
          0.5
        ]
      }
    },
    "CWE-476": {
      "baseline_accuracy": 0.5,
      "steered_accuracy": 0.5,
      "average_improvement": 0.0,
      "baseline_confidence": 0.5,
      "steered_confidence": 0.5,
      "positive_improvements": 0,
      "negative_improvements": 0,
      "no_change": 6,
      "total_examples": 6,
      "detailed_results": {
        "baseline_correct": 3,
        "steered_correct": 3,
        "total_examples": 6,
        "improvements": [
          0,
          0,
          0,
          0,
          0,
          0
        ],
        "examples": [
          {
            "filename": "1.c",
            "expected_vulnerable": true,
            "baseline_response": "ERROR_BASELINE_GENERATION",
            "steered_response": "ERROR_STEERED_GENERATION",
            "baseline_correct": false,
            "steered_correct": false,
            "baseline_confidence": 0.5,
            "steered_confidence": 0.5,
            "improvement": 0
          },
          {
            "filename": "2.c",
            "expected_vulnerable": true,
            "baseline_response": "ERROR_BASELINE_GENERATION",
            "steered_response": "ERROR_STEERED_GENERATION",
            "baseline_correct": false,
            "steered_correct": false,
            "baseline_confidence": 0.5,
            "steered_confidence": 0.5,
            "improvement": 0
          },
          {
            "filename": "3.c",
            "expected_vulnerable": true,
            "baseline_response": "ERROR_BASELINE_GENERATION",
            "steered_response": "ERROR_STEERED_GENERATION",
            "baseline_correct": false,
            "steered_correct": false,
            "baseline_confidence": 0.5,
            "steered_confidence": 0.5,
            "improvement": 0
          },
          {
            "filename": "p_1.c",
            "expected_vulnerable": false,
            "baseline_response": "ERROR_BASELINE_GENERATION",
            "steered_response": "ERROR_STEERED_GENERATION",
            "baseline_correct": true,
            "steered_correct": true,
            "baseline_confidence": 0.5,
            "steered_confidence": 0.5,
            "improvement": 0
          },
          {
            "filename": "p_2.c",
            "expected_vulnerable": false,
            "baseline_response": "ERROR_BASELINE_GENERATION",
            "steered_response": "ERROR_STEERED_GENERATION",
            "baseline_correct": true,
            "steered_correct": true,
            "baseline_confidence": 0.5,
            "steered_confidence": 0.5,
            "improvement": 0
          },
          {
            "filename": "p_3.c",
            "expected_vulnerable": false,
            "baseline_response": "ERROR_BASELINE_GENERATION",
            "steered_response": "ERROR_STEERED_GENERATION",
            "baseline_correct": true,
            "steered_correct": true,
            "baseline_confidence": 0.5,
            "steered_confidence": 0.5,
            "improvement": 0
          }
        ],
        "baseline_confidence": [
          0.5,
          0.5,
          0.5,
          0.5,
          0.5,
          0.5
        ],
        "steered_confidence": [
          0.5,
          0.5,
          0.5,
          0.5,
          0.5,
          0.5
        ]
      }
    },
    "CWE-77": {
      "baseline_accuracy": 0.5,
      "steered_accuracy": 0.5,
      "average_improvement": 0.0,
      "baseline_confidence": 0.5,
      "steered_confidence": 0.5,
      "positive_improvements": 0,
      "negative_improvements": 0,
      "no_change": 6,
      "total_examples": 6,
      "detailed_results": {
        "baseline_correct": 3,
        "steered_correct": 3,
        "total_examples": 6,
        "improvements": [
          0,
          0,
          0,
          0,
          0,
          0
        ],
        "examples": [
          {
            "filename": "1.c",
            "expected_vulnerable": true,
            "baseline_response": "ERROR_BASELINE_GENERATION",
            "steered_response": "ERROR_STEERED_GENERATION",
            "baseline_correct": false,
            "steered_correct": false,
            "baseline_confidence": 0.5,
            "steered_confidence": 0.5,
            "improvement": 0
          },
          {
            "filename": "2.c",
            "expected_vulnerable": true,
            "baseline_response": "ERROR_BASELINE_GENERATION",
            "steered_response": "ERROR_STEERED_GENERATION",
            "baseline_correct": false,
            "steered_correct": false,
            "baseline_confidence": 0.5,
            "steered_confidence": 0.5,
            "improvement": 0
          },
          {
            "filename": "3.c",
            "expected_vulnerable": true,
            "baseline_response": "ERROR_BASELINE_GENERATION",
            "steered_response": "ERROR_STEERED_GENERATION",
            "baseline_correct": false,
            "steered_correct": false,
            "baseline_confidence": 0.5,
            "steered_confidence": 0.5,
            "improvement": 0
          },
          {
            "filename": "p_1.c",
            "expected_vulnerable": false,
            "baseline_response": "ERROR_BASELINE_GENERATION",
            "steered_response": "ERROR_STEERED_GENERATION",
            "baseline_correct": true,
            "steered_correct": true,
            "baseline_confidence": 0.5,
            "steered_confidence": 0.5,
            "improvement": 0
          },
          {
            "filename": "p_2.c",
            "expected_vulnerable": false,
            "baseline_response": "ERROR_BASELINE_GENERATION",
            "steered_response": "ERROR_STEERED_GENERATION",
            "baseline_correct": true,
            "steered_correct": true,
            "baseline_confidence": 0.5,
            "steered_confidence": 0.5,
            "improvement": 0
          },
          {
            "filename": "p_3.c",
            "expected_vulnerable": false,
            "baseline_response": "ERROR_BASELINE_GENERATION",
            "steered_response": "ERROR_STEERED_GENERATION",
            "baseline_correct": true,
            "steered_correct": true,
            "baseline_confidence": 0.5,
            "steered_confidence": 0.5,
            "improvement": 0
          }
        ],
        "baseline_confidence": [
          0.5,
          0.5,
          0.5,
          0.5,
          0.5,
          0.5
        ],
        "steered_confidence": [
          0.5,
          0.5,
          0.5,
          0.5,
          0.5,
          0.5
        ]
      }
    },
    "CWE-787": {
      "baseline_accuracy": 0.5,
      "steered_accuracy": 0.5,
      "average_improvement": 0.0,
      "baseline_confidence": 0.5,
      "steered_confidence": 0.5,
      "positive_improvements": 0,
      "negative_improvements": 0,
      "no_change": 6,
      "total_examples": 6,
      "detailed_results": {
        "baseline_correct": 3,
        "steered_correct": 3,
        "total_examples": 6,
        "improvements": [
          0,
          0,
          0,
          0,
          0,
          0
        ],
        "examples": [
          {
            "filename": "1.c",
            "expected_vulnerable": true,
            "baseline_response": "ERROR_BASELINE_GENERATION",
            "steered_response": "ERROR_STEERED_GENERATION",
            "baseline_correct": false,
            "steered_correct": false,
            "baseline_confidence": 0.5,
            "steered_confidence": 0.5,
            "improvement": 0
          },
          {
            "filename": "2.c",
            "expected_vulnerable": true,
            "baseline_response": "ERROR_BASELINE_GENERATION",
            "steered_response": "ERROR_STEERED_GENERATION",
            "baseline_correct": false,
            "steered_correct": false,
            "baseline_confidence": 0.5,
            "steered_confidence": 0.5,
            "improvement": 0
          },
          {
            "filename": "3.c",
            "expected_vulnerable": true,
            "baseline_response": "ERROR_BASELINE_GENERATION",
            "steered_response": "ERROR_STEERED_GENERATION",
            "baseline_correct": false,
            "steered_correct": false,
            "baseline_confidence": 0.5,
            "steered_confidence": 0.5,
            "improvement": 0
          },
          {
            "filename": "p_1.c",
            "expected_vulnerable": false,
            "baseline_response": "ERROR_BASELINE_GENERATION",
            "steered_response": "ERROR_STEERED_GENERATION",
            "baseline_correct": true,
            "steered_correct": true,
            "baseline_confidence": 0.5,
            "steered_confidence": 0.5,
            "improvement": 0
          },
          {
            "filename": "p_2.c",
            "expected_vulnerable": false,
            "baseline_response": "ERROR_BASELINE_GENERATION",
            "steered_response": "ERROR_STEERED_GENERATION",
            "baseline_correct": true,
            "steered_correct": true,
            "baseline_confidence": 0.5,
            "steered_confidence": 0.5,
            "improvement": 0
          },
          {
            "filename": "p_3.c",
            "expected_vulnerable": false,
            "baseline_response": "ERROR_BASELINE_GENERATION",
            "steered_response": "ERROR_STEERED_GENERATION",
            "baseline_correct": true,
            "steered_correct": true,
            "baseline_confidence": 0.5,
            "steered_confidence": 0.5,
            "improvement": 0
          }
        ],
        "baseline_confidence": [
          0.5,
          0.5,
          0.5,
          0.5,
          0.5,
          0.5
        ],
        "steered_confidence": [
          0.5,
          0.5,
          0.5,
          0.5,
          0.5,
          0.5
        ]
      }
    },
    "CWE-79": {
      "baseline_accuracy": 0.5,
      "steered_accuracy": 0.5,
      "average_improvement": 0.0,
      "baseline_confidence": 0.5,
      "steered_confidence": 0.5,
      "positive_improvements": 0,
      "negative_improvements": 0,
      "no_change": 6,
      "total_examples": 6,
      "detailed_results": {
        "baseline_correct": 3,
        "steered_correct": 3,
        "total_examples": 6,
        "improvements": [
          0,
          0,
          0,
          0,
          0,
          0
        ],
        "examples": [
          {
            "filename": "1.py",
            "expected_vulnerable": true,
            "baseline_response": "ERROR_BASELINE_GENERATION",
            "steered_response": "ERROR_STEERED_GENERATION",
            "baseline_correct": false,
            "steered_correct": false,
            "baseline_confidence": 0.5,
            "steered_confidence": 0.5,
            "improvement": 0
          },
          {
            "filename": "2.py",
            "expected_vulnerable": true,
            "baseline_response": "ERROR_BASELINE_GENERATION",
            "steered_response": "ERROR_STEERED_GENERATION",
            "baseline_correct": false,
            "steered_correct": false,
            "baseline_confidence": 0.5,
            "steered_confidence": 0.5,
            "improvement": 0
          },
          {
            "filename": "3.py",
            "expected_vulnerable": true,
            "baseline_response": "ERROR_BASELINE_GENERATION",
            "steered_response": "ERROR_STEERED_GENERATION",
            "baseline_correct": false,
            "steered_correct": false,
            "baseline_confidence": 0.5,
            "steered_confidence": 0.5,
            "improvement": 0
          },
          {
            "filename": "p_1.py",
            "expected_vulnerable": false,
            "baseline_response": "ERROR_BASELINE_GENERATION",
            "steered_response": "ERROR_STEERED_GENERATION",
            "baseline_correct": true,
            "steered_correct": true,
            "baseline_confidence": 0.5,
            "steered_confidence": 0.5,
            "improvement": 0
          },
          {
            "filename": "p_2.py",
            "expected_vulnerable": false,
            "baseline_response": "ERROR_BASELINE_GENERATION",
            "steered_response": "ERROR_STEERED_GENERATION",
            "baseline_correct": true,
            "steered_correct": true,
            "baseline_confidence": 0.5,
            "steered_confidence": 0.5,
            "improvement": 0
          },
          {
            "filename": "p_3.py",
            "expected_vulnerable": false,
            "baseline_response": "ERROR_BASELINE_GENERATION",
            "steered_response": "ERROR_STEERED_GENERATION",
            "baseline_correct": true,
            "steered_correct": true,
            "baseline_confidence": 0.5,
            "steered_confidence": 0.5,
            "improvement": 0
          }
        ],
        "baseline_confidence": [
          0.5,
          0.5,
          0.5,
          0.5,
          0.5,
          0.5
        ],
        "steered_confidence": [
          0.5,
          0.5,
          0.5,
          0.5,
          0.5,
          0.5
        ]
      }
    },
    "CWE-89": {
      "baseline_accuracy": 0.5,
      "steered_accuracy": 0.5,
      "average_improvement": 0.0,
      "baseline_confidence": 0.5,
      "steered_confidence": 0.5,
      "positive_improvements": 0,
      "negative_improvements": 0,
      "no_change": 6,
      "total_examples": 6,
      "detailed_results": {
        "baseline_correct": 3,
        "steered_correct": 3,
        "total_examples": 6,
        "improvements": [
          0,
          0,
          0,
          0,
          0,
          0
        ],
        "examples": [
          {
            "filename": "1.py",
            "expected_vulnerable": true,
            "baseline_response": "ERROR_BASELINE_GENERATION",
            "steered_response": "ERROR_STEERED_GENERATION",
            "baseline_correct": false,
            "steered_correct": false,
            "baseline_confidence": 0.5,
            "steered_confidence": 0.5,
            "improvement": 0
          },
          {
            "filename": "2.py",
            "expected_vulnerable": true,
            "baseline_response": "ERROR_BASELINE_GENERATION",
            "steered_response": "ERROR_STEERED_GENERATION",
            "baseline_correct": false,
            "steered_correct": false,
            "baseline_confidence": 0.5,
            "steered_confidence": 0.5,
            "improvement": 0
          },
          {
            "filename": "3.py",
            "expected_vulnerable": true,
            "baseline_response": "ERROR_BASELINE_GENERATION",
            "steered_response": "ERROR_STEERED_GENERATION",
            "baseline_correct": false,
            "steered_correct": false,
            "baseline_confidence": 0.5,
            "steered_confidence": 0.5,
            "improvement": 0
          },
          {
            "filename": "p_1.py",
            "expected_vulnerable": false,
            "baseline_response": "ERROR_BASELINE_GENERATION",
            "steered_response": "ERROR_STEERED_GENERATION",
            "baseline_correct": true,
            "steered_correct": true,
            "baseline_confidence": 0.5,
            "steered_confidence": 0.5,
            "improvement": 0
          },
          {
            "filename": "p_2.py",
            "expected_vulnerable": false,
            "baseline_response": "ERROR_BASELINE_GENERATION",
            "steered_response": "ERROR_STEERED_GENERATION",
            "baseline_correct": true,
            "steered_correct": true,
            "baseline_confidence": 0.5,
            "steered_confidence": 0.5,
            "improvement": 0
          },
          {
            "filename": "p_3.py",
            "expected_vulnerable": false,
            "baseline_response": "ERROR_BASELINE_GENERATION",
            "steered_response": "ERROR_STEERED_GENERATION",
            "baseline_correct": true,
            "steered_correct": true,
            "baseline_confidence": 0.5,
            "steered_confidence": 0.5,
            "improvement": 0
          }
        ],
        "baseline_confidence": [
          0.5,
          0.5,
          0.5,
          0.5,
          0.5,
          0.5
        ],
        "steered_confidence": [
          0.5,
          0.5,
          0.5,
          0.5,
          0.5,
          0.5
        ]
      }
    }
  },
  "nnsight_version": "0.4.10"
}